<!DOCTYPE html>
<html xmlns:th="http://www.thmeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>List</title>
</head>
<body>
<header>
    <form>
        <label>상품 찾기 : </label>
        <input type="text" th:field="*{productPageRequest.keyword}" />
        <input type="submit" value="검색"/>
        <span th:if="${#fields.hasErrors('productPageRequest.keyword')}"
              th:errors="*{productPageRequest.keyword}" style="color:red">Incorrect Data</span>
    </form>
</header>
<div class="product_list_top">
    <hr>
    <p>
        <a th:href="@{/}">홈 </a>
        <a th:href="@{/product/list(manufacturer=${param.manufacturer})}">
            > <span th:text="(${manufacturer} ? ${manufacturer} : '전체')">(제조사)</span>
        </a>
        <a th:if="${category} != null"
           th:href="@{/product/list(manufacturer=${param.manufacturer}, category=${param.category})}">
            > <span th:text="${category}">(분류)</span>
        </a>
        <a th:if="${productPageRequest.keyword} != null"
           th:href="@{/product/list(keyword=${param.keyword})}">> <span>검색 결과</span></a>
    </p>

    <labe>제조사</labe>
    <ul>
        <li><a th:href="@{/product/list}">전체</a></li>
        <li th:each="ma : ${manufacturers}">
            <a th:href="@{/product/list(manufacturer=${ma.id})}"
               th:text="${ma.name}">(제조사 이름)</a>
        </li>
    </ul>
    <labe>분류</labe>
    <ul>
        <li><a th:href="@{/product/list(manufacturer=${param.manufacturer})}">전체</a></li>
        <li th:each="ca : ${categories}">
            <a th:href="@{/product/list(manufacturer=${param.manufacturer}, category=${ca.id})}"
               th:text="${ca.name}">(분류 이름)</a>
        </li>
    </ul>

    <label>정렬방식 : </label>
    <select th:field=*{productPageRequest.sort_method} >
        <option th:each="method,idx : ${sort_method}"
                th:value="${idx.index}"
                th:text="${method.link}"
                th:label="${method.text}">(정렬 방식)</option>
    </select>
</div>
<div class="product_list_body">
    <div th:each="product : ${products}">
        <hr>
        <a th:href="@{/product/detail/{id}(id=${product.id})}">
            <img th:unless="${product.imageLink}" th:src="@{/assets/magnifying-glass-solid.svg}" title="not found" alt="not found" style="width:120px">
            <img th:if="${product.imageLink}" th:src="${product.imageLink}" th:title="${product.name}" th:alt="${product.name}" style="width:120px">
            <p><b th:text="${product.name}">(상품이름)</b> | <span th:text="${#numbers.formatInteger(product.price, 3, 'COMMA')}">(상품가격)</span> 원</p>
        </a>
    </div>
</div>
<div class="product_list_bottom">
    <a th:href="${pagination.first.link}" th:text="${pagination.first.text}">First</a>
    <a th:href="${pagination.previous.link}" th:text="${pagination.previous.text}">Previous</a>
    <span th:each="page : ${pagination.page}">
        <a th:href="${page.link}" th:text="${page.text}">(Page Number)</a>
    </span>
    <a th:href="${pagination.next.link}" th:text="${pagination.next.text}">Next</a>
    <a th:href="${pagination.last.link}" th:text="${pagination.last.text}">Last</a>
</div>
<script>
    document.getElementById("sort_method")
        .addEventListener("change", function () {
            location.href = this[this.selectedIndex].text;
    });
</script>
</body>
</html>